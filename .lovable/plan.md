
# ุฎุทุฉ ุฅูุดุงุก ููุตุฉ ุฃุชูุชุฉ ุงูููุฏูู

## ูุธุฑุฉ ุนุงูุฉ
ููุตุฉ ููุจ ุจุณูุทุฉ ุจูุถุน ุฏุงูู ุชููู ุจูููุชูู ุฑุฆูุณูุชูู:
1. **ุฏูุฌ ุงููุณุงุฆุท**: ุงุณุชูุจุงู ุตูุฑ/ููุฏูููุงุช ูุน ุฃุตูุงุช ูุฏูุฌูุง ุนุจุฑ FFmpeg ุนูู Hugging Face
2. **ุฅูุดุงุก ููุฏูู ุฐูู**: ุงุณุชูุจุงู ุฃูุงูุฑ ูู Telegram ูุฅูุดุงุก ููุฏูููุงุช ูุงููุฉ ููุดุฑูุง ุชููุงุฆูุงู

---

## ุงููุฑุญูุฉ ุงูุฃููู: ุงูุจููุฉ ุงูุชุญุชูุฉ

### 1.1 ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase)

**ุงูุฌุฏุงูู ุงููุทููุจุฉ:**

```text
jobs (ุฌุฏูู ุงูููุงู)
โโโ id (uuid, primary key)
โโโ type (enum: 'merge' | 'ai_generate')
โโโ status (enum: 'pending' | 'processing' | 'completed' | 'failed')
โโโ progress (integer: 0-100)
โโโ source_url (text) - ุฑุงุจุท ุงูุทูุจ ุงูุฃุตูู
โโโ callback_url (text) - ุฑุงุจุท ุงูุฅุฑุฌุงุน
โโโ input_data (jsonb) - ุจูุงูุงุช ุงูุฅุฏุฎุงู
โโโ output_url (text) - ุฑุงุจุท ุงูููุฏูู ุงูููุงุฆู
โโโ error_message (text)
โโโ created_at (timestamp)
โโโ updated_at (timestamp)

elevenlabs_keys (ููุงุชูุญ ElevenLabs)
โโโ id (uuid, primary key)
โโโ api_key (text, encrypted)
โโโ name (text) - ุงุณู ุงูููุชุงุญ
โโโ usage_count (integer) - ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช
โโโ last_used_at (timestamp)
โโโ is_active (boolean)
โโโ created_at (timestamp)

settings (ุงูุฅุนุฏุงุฏุงุช)
โโโ id (uuid, primary key)
โโโ key (text, unique)
โโโ value (text)
โโโ updated_at (timestamp)
```

### 1.2 ุชุฎุฒูู ุงููููุงุช (Supabase Storage)

**ุงูู Buckets ุงููุทููุจุฉ:**
- `media-input` - ุงููููุงุช ุงููุงุฑุฏุฉ (ุตูุฑุ ููุฏูููุงุชุ ุฃุตูุงุช)
- `media-output` - ุงูููุฏูููุงุช ุงูููุงุฆูุฉ
- `temp-files` - ูููุงุช ูุคูุชุฉ ูููุนุงูุฌุฉ

---

## ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุงููุงุฌูุฉ ุงูุฃูุงููุฉ

### 2.1 ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (ูุงุฌูุฉ ุจุณูุทุฉ - ูุถุน ุฏุงูู)

**ุงูููููุงุช:**

```text
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ฌ Video Automation Platform              [๐ Dark Mode]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ                  โ
โ  โ   ๐ Active     โ  โ   โ Completed   โ                  โ
โ  โ   Jobs: 3       โ  โ   Today: 15      โ                  โ
โ  โโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโ                  โ
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ  Recent Jobs                                         โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ   โ
โ  โ  ๐ Video #1234  โ AI Generate โ 75% โโโโโโโโโโโ    โ   โ
โ  โ  โ Video #1233  โ Merge       โ Complete           โ   โ
โ  โ  โ Video #1232  โ AI Generate โ Failed             โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ  โ๏ธ Settings                                         โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ   โ
โ  โ  Telegram Token: [โขโขโขโขโขโขโขโขโขโขโขโขโขโขโขโข] [Save]          โ   โ
โ  โ                                                      โ   โ
โ  โ  ElevenLabs Keys (Auto-Rotation):                   โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ   โ
โ  โ  โ Key 1: โขโขโขโขxxxx  โ Uses: 45 โ [โ Remove]  โ     โ   โ
โ  โ  โ Key 2: โขโขโขโขyyyy  โ Uses: 12 โ [โ Remove]  โ     โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ   โ
โ  โ  [+ Add New Key]                                    โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 2.2 ูููู ุงููููุงุช ูููุงุฌูุฉ

```text
src/
โโโ pages/
โ   โโโ Index.tsx (ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ)
โโโ components/
โ   โโโ dashboard/
โ   โ   โโโ StatsCards.tsx (ุฅุญุตุงุฆูุงุช ุงูููุงู)
โ   โ   โโโ JobsList.tsx (ูุงุฆูุฉ ุงูููุงู)
โ   โ   โโโ JobCard.tsx (ุจุทุงูุฉ ุงููููุฉ)
โ   โ   โโโ ProgressBar.tsx (ุดุฑูุท ุงูุชูุฏู)
โ   โโโ settings/
โ   โ   โโโ SettingsPanel.tsx (ููุญุฉ ุงูุฅุนุฏุงุฏุงุช)
โ   โ   โโโ TelegramSettings.tsx (ุฅุนุฏุงุฏุงุช Telegram)
โ   โ   โโโ ElevenLabsKeys.tsx (ุฅุฏุงุฑุฉ ููุงุชูุญ ElevenLabs)
โ   โโโ ui/ (ุงูููููุงุช ุงูููุฌูุฏุฉ)
โโโ hooks/
โ   โโโ useJobs.ts (ุฅุฏุงุฑุฉ ุงูููุงู)
โ   โโโ useSettings.ts (ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช)
โ   โโโ useElevenLabsKeys.ts (ุฅุฏุงุฑุฉ ุงูููุงุชูุญ)
โโโ lib/
    โโโ api.ts (ุฏูุงู API)
```

---

## ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ุงูุฎุฏูุงุช ุงูุฎูููุฉ (Edge Functions)

### 3.1 ูููู Edge Functions

```text
supabase/functions/
โโโ merge-media/          # ุงููููุฉ ุงูุฃููู: ุฏูุฌ ุงููุณุงุฆุท
โ   โโโ index.ts
โโโ ai-generate/          # ุงููููุฉ ุงูุซุงููุฉ: ุฅูุดุงุก ููุฏูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
โ   โโโ index.ts
โโโ telegram-webhook/     # ุงุณุชูุจุงู ุฑุณุงุฆู Telegram
โ   โโโ index.ts
โโโ process-job/          # ูุนุงูุฌุฉ ุงูููุงู
โ   โโโ index.ts
โโโ publish-video/        # ูุดุฑ ุงูููุฏูู ุนูู ุงูููุตุงุช
โ   โโโ index.ts
โโโ callback-sender/      # ุฅุฑุณุงู ุงูุชุญุฏูุซุงุช ูููุตุฏุฑ
โ   โโโ index.ts
โโโ _shared/
    โโโ supabase.ts
    โโโ elevenlabs.ts     # ุงูุชุฏููุฑ ุงูุชููุงุฆู ููููุงุชูุญ
    โโโ gemini.ts
    โโโ huggingface.ts
    โโโ social-publish.ts
```

### 3.2 ุงููููุฉ ุงูุฃููู: ุฏูุฌ ุงููุณุงุฆุท (merge-media)

**ุงูุชุฏูู:**
```text
1. ุงุณุชูุจุงู ุงูุทูุจ (ุตูุฑ/ููุฏูููุงุช + ุฃุตูุงุช + callback_url)
       โ
2. ุฑูุน ุงููููุงุช ุฅูู Supabase Storage
       โ
3. ุฅูุดุงุก ุณุฌู ูู ุฌุฏูู jobs
       โ
4. ุฅุฑุณุงู ูููุนุงูุฌุฉ ุนูู Hugging Face Space
   (https://elmalik-ff.hf.space)
       โ
5. ูุชุงุจุนุฉ ุงูุชูุฏู ูุชุญุฏูุซ ุงูู progress
       โ
6. ุนูุฏ ุงูุงูุชูุงุก: ุญูุธ ุงูููุฏูู ุงูููุงุฆู
       โ
7. ุฅุฑุณุงู callback ูููุตุฏุฑ ูุน ุฑุงุจุท ุงูููุฏูู ููุณุจุฉ ุงููุฌุงุญ
```

### 3.3 ุงููููุฉ ุงูุซุงููุฉ: ุฅูุดุงุก ููุฏูู ุฐูู (ai-generate)

**ุงูุชุฏูู ุงููุงูู:**
```text
1. ุงุณุชูุจุงู ุฑุณุงูุฉ Telegram (ุนููุงูุ ูุตูุ ููุน ุงูุตูุชุ ุนุฏุฏ ุงููุดุงูุฏุ ุงูุทูู)
       โ
2. ุฅูุดุงุก ุณูุฑุจุช ุตูุชู ุจู Gemini
   - ุชุญููู ุงููุนูููุงุช ุงููุฑุณูุฉ
   - ุฅูุดุงุก ูุต ุชุนููู ุตูุชู ููุงุณุจ
       โ
3. ุฅูุดุงุก ุงูุชุนููู ุงูุตูุชู ุจู ElevenLabs
   - ุงุณุชุฎุฏุงู ุงูุชุฏููุฑ ุงูุชููุงุฆู ููููุงุชูุญ
   - ุงุฎุชูุงุฑ ุฃูู ููุชุงุญ ุงุณุชุฎุฏุงูุงู
       โ
4. ุฅูุดุงุก ุฃูุตุงู ุงูุตูุฑ ุจู Gemini (ุจุงูุฅูุฌููุฒูุฉ)
   - ุชูุณูู ุงูุณูุฑุจุช ููุดุงูุฏ
   - ูุตู ุจุตุฑู ููู ูุดูุฏ
       โ
5. ุฅูุดุงุก ุงูุตูุฑ ุจู Flux ุนูู Hugging Face
   - ุงุณุชุฎุฏุงู ูููุฐุฌ Flux ุงููุฌุงูู
   - ุฅูุดุงุก ุตูุฑุฉ ููู ูุดูุฏ
       โ
6. ุฏูุฌ ุงูุตูุฑ ูุน ุงูุตูุช (ูุซู ุงููููุฉ ุงูุฃููู)
       โ
7. ูุดุฑ ุงูููุฏูู ุชููุงุฆูุงู ุนูู:
   - Instagram (ุจุงุณุชุฎุฏุงู Graph API)
   - Facebook (ุจุงุณุชุฎุฏุงู Graph API)
   - YouTube (ุจุงุณุชุฎุฏุงู YouTube Data API v3)
       โ
8. ุฅุฑุณุงู ุชุฃููุฏ ูู Telegram
```

### 3.4 ูุธุงู ุงูุชุฏููุฑ ุงูุชููุงุฆู ูู ElevenLabs

```text
function getNextElevenLabsKey():
    1. ุฌูุจ ุฌููุน ุงูููุงุชูุญ ุงููุดุทุฉ ูู ุงูุฌุฏูู
    2. ุชุฑุชูุจูุง ุญุณุจ ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช (ุงูุฃูู ุฃููุงู)
    3. ุงุฎุชูุงุฑ ุงูููุชุงุญ ุงูุฃูู
    4. ุชุญุฏูุซ usage_count ู last_used_at
    5. ุฅุฑุฌุงุน ุงูููุชุงุญ
```

---

## ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ: ุงูุชูุงููุงุช ุงูุฎุงุฑุฌูุฉ

### 4.1 Hugging Face Space Integration

**Endpoint:** `https://elmalik-ff.hf.space`

**ููุฏูุฌ:**
```text
POST /merge
Body: {
  images: [url1, url2, ...],
  videos: [url1, ...],
  audio: url,
  output_format: "mp4"
}
Response: {
  status: "processing" | "completed" | "failed",
  progress: 0-100,
  output_url: "..."
}
```

**ูุฅูุดุงุก ุงูุตูุฑ (Flux):**
```text
ุงุณุชุฎุฏุงู API ุงูุฎุงุต ุจู Hugging Face ูุน ูููุฐุฌ Flux
Headers: { Authorization: "Bearer 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" }
```

### 4.2 Telegram Bot Integration

**ุงูุฅุนุฏุงุฏ:**
- ุฅูุดุงุก Webhook ูุดูุฑ ุฅูู Edge Function
- ุงุณุชูุจุงู ุงูุฑุณุงุฆู ููุนุงูุฌุชูุง
- ุฅุฑุณุงู ุชุญุฏูุซุงุช ุงูุญุงูุฉ ูููุณุชุฎุฏู

**ุตูุบุฉ ุงูุฑุณุงูุฉ ุงููุชููุนุฉ:**
```text
/create
ุนููุงู: ููู ุชูุฌุญ ูู ุงูุญูุงุฉ
ูุตู: ููุฏูู ุชุญููุฒู ุนู ุงููุฌุงุญ
ููุน_ุงูุตูุช: male_arabic
ุนุฏุฏ_ุงููุดุงูุฏ: 5
ุงูุทูู: 60
```

### 4.3 ูุดุฑ ุงูููุฏูู ุนูู ุงูููุตุงุช

**Instagram & Facebook (Graph API):**
- ุงุณุชุฎุฏุงู Access Tokens ุงูููุฏูุฉ
- ุฑูุน ุงูููุฏูู ููุดุฑู ูุน ุงูุนููุงู ูุงููุตู

**YouTube (Data API v3):**
- OAuth 2.0 ุจุงุณุชุฎุฏุงู Client ID ู Secret
- ุฑูุน ุงูููุฏูู ูุชุนููู ุงูุนููุงู ูุงููุตู ูุงูู Tags

---

## ุงููุฑุญูุฉ ุงูุฎุงูุณุฉ: ุงูุฃูุงู ูุงูููุงุชูุญ

### 5.1 ุชุฎุฒูู ุงูููุงุชูุญ (Supabase Secrets)

**ุงูููุงุชูุญ ุงููุทููุจุฉ:**
```text
GEMINI_API_KEY=AIzaSyCwFwGMFtMuqvboNAqBI7EL2Fz4UjjZ_TM
YOUTUBE_CLIENT_ID=940535669869-step2gv6i3sdtngh7act08nibpreu192.apps.googleusercontent.com
YOUTUBE_CLIENT_SECRET=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
FACEBOOK_ACCESS_TOKEN=EAAM0AmT9FKcBQuG3VA...
INSTAGRAM_ACCESS_TOKEN=EAALplRkgJSsBQt7RmST...
HF_READ_TOKEN=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
HF_WRITE_TOKEN=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
HF_SPACE_URL=https://elmalik-ff.hf.space
```

**ููุงุญุธุฉ:** ููุงุชูุญ ElevenLabs ู Telegram Token ุณุชูุฎุฒู ูู ุฌุฏูู `settings` ู `elevenlabs_keys` ููุชููู ุงููุณุชุฎุฏู ูู ุฅุฏุงุฑุชูุง ูู ุงููุงุฌูุฉ.

---

## ููุฎุต ุฎุทูุงุช ุงูุชูููุฐ

| ุงูุฎุทูุฉ | ุงููุตู | ุงูุฃููููุฉ |
|--------|-------|----------|
| 1 | ุฅูุดุงุก ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (jobs, elevenlabs_keys, settings) | ุนุงููุฉ |
| 2 | ุฅูุดุงุก Storage Buckets | ุนุงููุฉ |
| 3 | ุชุทุจูู ุงููุถุน ุงูุฏุงูู ูุชุตููู ุงููุงุฌูุฉ ุงูุจุณูุทุฉ | ุนุงููุฉ |
| 4 | ุฅูุดุงุก ููููุงุช Dashboard (StatsCards, JobsList) | ุนุงููุฉ |
| 5 | ุฅูุดุงุก ููููุงุช Settings (ุฅุฏุงุฑุฉ ุงูููุงุชูุญ) | ุนุงููุฉ |
| 6 | ุฅูุดุงุก Edge Function ููุฏูุฌ (merge-media) | ุนุงููุฉ |
| 7 | ุฅูุดุงุก Edge Function ูู Telegram Webhook | ุนุงููุฉ |
| 8 | ุฅูุดุงุก Edge Function ููุฅูุดุงุก ุงูุฐูู (ai-generate) | ุนุงููุฉ |
| 9 | ุชูุงูู Gemini ููุณูุฑุจุชุงุช ูุงูุฃูุตุงู | ุนุงููุฉ |
| 10 | ุชูุงูู ElevenLabs ูุน ุงูุชุฏููุฑ ุงูุชููุงุฆู | ุนุงููุฉ |
| 11 | ุชูุงูู Flux ูุฅูุดุงุก ุงูุตูุฑ | ุนุงููุฉ |
| 12 | ุฅูุดุงุก Edge Function ูููุดุฑ (publish-video) | ูุชูุณุทุฉ |
| 13 | ุชูุงูู Instagram & Facebook | ูุชูุณุทุฉ |
| 14 | ุชูุงูู YouTube | ูุชูุณุทุฉ |
| 15 | ูุธุงู ุงูู Callbacks ูุชุชุจุน ุงูุชูุฏู | ูุชูุณุทุฉ |

---

## ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

- **Frontend**: React + TypeScript + Tailwind CSS + shadcn/ui
- **Backend**: Supabase Edge Functions (Deno)
- **Database**: Supabase PostgreSQL
- **Storage**: Supabase Storage
- **AI**: Gemini API (ุณูุฑุจุชุงุช ูุฃูุตุงู)
- **Voice**: ElevenLabs API (ุชุนููู ุตูุชู)
- **Images**: Hugging Face Flux (ุฅูุดุงุก ุตูุฑ)
- **Video**: FFmpeg ุนูู Hugging Face Space
- **Social**: Meta Graph API (Instagram & Facebook) + YouTube Data API

